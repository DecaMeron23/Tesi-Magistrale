/*
 * srv_general.c
 *
 *  Created on: 14 gen 2026
 *      Author: emilio
 */

#include "Services/General/srv_general.h"
#include "main.h"

void SRV_GENERAL_Init(void)
{
	// NON FA NULLA
}

void SRV_GENERAL_WriteCalendar(uint8_t *CharData)
{
	RTC_HandleTypeDef *hrtc = MAIN_GetHandelrRTC();

	RTC_DateTypeDef sDate =
	{ 0 };

	RTC_TimeTypeDef sTime =
	{ 0 };

	sDate.Year = CharData[0];
	sDate.Month = CharData[1];
	sDate.Date = CharData[2];
	sDate.WeekDay = CharData[3];

	sTime.Hours = CharData[4];
	sTime.Minutes = CharData[5];
	sTime.Seconds = CharData[6];

	HAL_RTC_SetDate(hrtc, &sDate, RTC_FORMAT_BCD);
	HAL_RTC_SetTime(hrtc, &sTime, RTC_FORMAT_BCD);

}
void SRV_GENERAL_ReadCalendar(uint8_t *CharData)
{
	RTC_HandleTypeDef *hrtc = MAIN_GetHandelrRTC();

	RTC_DateTypeDef sDate =
	{ 0 };

	RTC_TimeTypeDef sTime =
	{ 0 };

	HAL_RTC_GetDate(hrtc, &sDate, RTC_FORMAT_BCD);
	HAL_RTC_GetTime(hrtc, &sTime, RTC_FORMAT_BCD);

	CharData[0] = sDate.Year;
	CharData[1] = sDate.Month;
	CharData[2] = sDate.Date;
	CharData[3] = sDate.WeekDay;

	CharData[4] = sTime.Hours;
	CharData[5] = sTime.Minutes;
	CharData[6] = sTime.Seconds;

	Custom_STM_App_Update_Char(CUSTOM_STM_TIME_CHAR, CharData)
}
