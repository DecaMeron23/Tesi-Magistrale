/*
 * pwmsignal.h
 *
 *  Created on: 24 dic 2025
 *      Author: emilio
 */

#ifndef __PWMSIGNAL_H_
#define __PWMSIGNAL_H_

#include <stdint.h>

#ifndef __MAIN_H
// Definizione della struttura TIM_HandleTypeDef
typedef struct __TIM_HandleTypeDef TIM_HandleTypeDef;
#endif

typedef struct {
  uint32_t prec;       // counter di start
  uint32_t cycle_time; // counter di uptime
  uint32_t up_time;    // counter di uptime
  uint32_t tim_freq;   // frequenza del timer
  uint8_t is_16_bit;   // booleano, che indica se è il contatore è da 16 bit
} PWM_SIGNAL_TypeDef;

void PWM_SIGNAL_Init(PWM_SIGNAL_TypeDef *s, uint32_t freq_clk, uint32_t pre_scaler,
                         uint8_t is_16_bit);

void PWM_SIGNAL_ComputePWM(PWM_SIGNAL_TypeDef *s, TIM_HandleTypeDef *htim, int channel,
                      uint8_t is_rising);

uint32_t getFrequency(PWM_SIGNAL_TypeDef *s);
uint32_t getDutyCycle(PWM_SIGNAL_TypeDef *s);

#endif /* PWMSIGNAL_H_ */
