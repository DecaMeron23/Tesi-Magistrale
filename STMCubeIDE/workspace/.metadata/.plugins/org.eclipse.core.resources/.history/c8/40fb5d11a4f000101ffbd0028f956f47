/*
 * srv_pwm_reader.c
 *
 *  Created on: 13 gen 2026
 *      Author: emilio
 */

#include "srv_pwm_reader.h"
#include "custom_stm.h"
#include "stdlib.h"
#include "app_conf.h"
#include "stm32_seq.h"

uint32_t getPWM();

void SRV_APP_ReadPWM(uint8_t *CharData)
{
	uint32_t freq = getPWM();
	CharData[0] = freq & 0xFF000000;
	CharData[1] = freq & 0x00FF0000;
	CharData[2] = freq & 0x0000FF00;
	CharData[3] = freq & 0x000000FF;
}

void SRV_APP_StartPwmNotify()
{
	UTIL_SEQ_ResumeTask(1 << CFG_TASK_NOTIFY_PWM_ID);
	UTIL_SEQ_SetTask(1 << CFG_TASK_NOTIFY_PWM_ID , CFG_SCH_PRIO_0);

}
void SRV_APP_StopPwmNotify()
{
	UTIL_SEQ_PauseTask(1 << CFG_TASK_NOTIFY_PWM_ID);
}

uint32_t getPWM()
{
	return rand() % 10000 + 1000;
}
